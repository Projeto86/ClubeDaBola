scheduler.toPDF=function(B,F,E,K){var P=0;var O=0;F=F||"color";function H(Q){Q=parseFloat(Q);if(isNaN(Q)){return"auto"}return 100*Q/P}function N(Q){Q=parseFloat(Q);if(isNaN(Q)){return"auto"}return 100*Q/O}function C(R){var Q="";for(var S=0;S<R.length;S++){Q+="\n<column><![CDATA["+R[S].innerHTML+"]]></column>"}P=R[0].offsetWidth;return Q}function M(S,T){var Q=parseInt(S.style.left);for(var R=0;R<scheduler._cols.length;R++){Q-=scheduler._cols[R];if(Q<0){return R}}return T}function A(R,T){var S=parseInt(R.style.top);for(var Q=0;Q<scheduler._colsS.heights.length;Q++){if(scheduler._colsS.heights[Q]>S){return Q}}return T}function I(T){var R="";var U=T.firstChild.rows;for(var S=0;S<U.length;S++){var V=[];for(var Q=0;Q<U[S].cells.length;Q++){V.push(U[S].cells[Q].firstChild.innerHTML)}R+="\n<row height='"+T.firstChild.rows[S].cells[0].offsetHeight+"'>"+V.join("|")+"</row>";O=T.firstChild.rows[0].cells[0].offsetHeight}return R}function D(U){var R="<data profile='"+U+"'";if(E){R+=" header='"+E+"'"}if(K){R+=" footer='"+K+"'"}R+=">";R+="<scale mode='"+scheduler._mode+"' today='"+scheduler._els.dhx_cal_date[0].innerHTML+"'>";if(scheduler._mode=="agenda"){var Q=scheduler._els.dhx_cal_header[0].childNodes[0].childNodes;R+="<column>"+Q[0].innerHTML+"</column><column>"+Q[1].innerHTML+"</column>"}else{if(scheduler._mode=="year"){var Q=scheduler._els.dhx_cal_data[0].childNodes;for(var S=0;S<Q.length;S++){R+="<month label='"+Q[S].childNodes[0].innerHTML+"'>";R+=C(Q[S].childNodes[1].childNodes);R+=I(Q[S].childNodes[2]);R+="</month>"}}else{R+="<x>";var Q=scheduler._els.dhx_cal_header[0].childNodes;R+=C(Q);R+="</x>";var T=scheduler._els.dhx_cal_data[0];if(T.firstChild.tagName=="TABLE"){R+=I(T)}else{T=T.childNodes[T.childNodes.length-1];if(T.className.indexOf("dhx_cal_event")!=-1){T=T.previousSibling}T=T.childNodes;R+="<y>";for(var S=0;S<T.length;S++){R+="\n<row><![CDATA["+T[S].innerHTML+"]]></row>"}R+="</y>";O=T[0].offsetHeight}}}R+="</scale>";return R}function L(){var Y="";var e=scheduler._rendered;if(scheduler._mode=="agenda"){for(var W=0;W<e.length;W++){Y+="<event><head>"+e[W].childNodes[0].innerHTML+"</head><body>"+e[W].childNodes[2].innerHTML+"</body></event>"}}else{if(scheduler._mode=="year"){var e=scheduler.get_visible_events();for(var W=0;W<e.length;W++){var b=e[W].start_date;if(b.valueOf()<scheduler._min_date.valueOf()){b=scheduler._min_date}while(b<e[W].end_date){var R=b.getMonth()+12*(b.getFullYear()-scheduler._min_date.getFullYear())-scheduler.week_starts._month;var c=scheduler.week_starts[R]+b.getDate()-1;Y+="<event day='"+(c%7)+"' week='"+Math.floor(c/7)+"' month='"+R+"'></event>";scheduler._mark_year_date(b);b=scheduler.date.add(b,1,"day");if(b.valueOf()>=scheduler._max_date.valueOf()){break}}}}else{for(var W=0;W<e.length;W++){var U=H(e[W].style.left);var S=N(e[W].style.top);var a=H(e[W].style.width);var X=N(e[W].style.height);var V=e[W].className.split(" ")[0].replace("dhx_cal_","");var Z=scheduler.getEvent(e[W].getAttribute("event_id"));var c=Z._sday;var Q=Z._sweek;if(scheduler._mode!="month"){if(parseInt(e[W].style.left)<=26){U=2;a+=H(e[W].style.left)-1}if(e[W].parentNode==scheduler._els.dhx_cal_data[0]){continue}U+=H(e[W].parentNode.style.left);U-=H(51)}else{X=parseInt(e[W].offsetHeight);S=parseInt(e[W].style.top)-22;c=M(e[W],c);Q=A(e[W],Q)}Y+="\n<event week='"+Q+"' day='"+c+"' type='"+V+"' x='"+U+"' y='"+S+"' width='"+a+"' height='"+X+"'>";if(V=="event"){Y+="<header><![CDATA["+e[W].childNodes[1].innerHTML+"]]></header>";var T=window.getComputedStyle?(window.getComputedStyle(e[W].childNodes[2],null)["backgroundColor"]):(e[W].childNodes[2].currentStyle.backgroundColor);Y+="<body color='"+T+"'><![CDATA["+e[W].childNodes[2].innerHTML+"]]></body>"}else{var T=window.getComputedStyle?(window.getComputedStyle(e[W],null)["backgroundColor"]):(e[W].currentStyle.backgroundColor);Y+="<body color='"+T+"'><![CDATA["+e[W].innerHTML+"]]></body>"}Y+="</event>"}}}return Y}function J(){var Q="</data>";return Q}var G=window.open("","_blank");G.document.open();G.document.write("<html><body>");G.document.write('<form id="mycollformname" method="post"  accept-charset="utf-8" enctype="multipart/form-data"  action="'+B+'"><input type="hidden" name="mycoolxmlbody" id="mycoolxmlbody"/> </form>');G.document.getElementById("mycoolxmlbody").value=D(F).replace("\u2013","-")+L()+J();G.document.write("</body></html>");G.document.getElementById("mycollformname").submit();G.document.close()};